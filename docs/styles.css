<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>لوحة رمضان — عمّان</title>
  <meta name="description" content="لوحة رمضان للفريق: الاسم + وقت الدخول فقط، خروج تلقائي (6.5 ساعات)، مواقيت عمّان، عدّاد الإفطار، وخريطة السير (Google Maps Traffic)." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="wrap">

    <!-- Top Bar -->
    <header class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 64 64" width="34" height="34" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M39 9.3C27.5 11 19 21 19 33c0 13.3 10.7 24 24 24 4.8 0 9.2-1.4 12.9-3.8C52.2 59.1 45.5 63 38 63 25.3 63 15 52.7 15 40 15 25.2 28 13.4 39 9.3Z" fill="rgba(246,227,180,.95)"/>
            <path d="M52.4 14.2l1.9 4.3 4.7.3-3.6 2.9 1.3 4.5-4.3-2.6-4.3 2.6 1.3-4.5-3.6-2.9 4.7-.3 1.9-4.3Z" fill="rgba(215,181,109,.95)"/>
          </svg>
        </div>
        <div>
          <div class="title">لوحة رمضان — عمّان</div>
          <div class="subtitle">إدخال <b>الاسم</b> + <b>وقت الدخول</b> فقط. <b>الخروج = دخولك + 6.5 ساعات</b> (بدون أي إضافة لوقت الصلاة).</div>
        </div>
      </div>

      <div class="statusRow">
        <div class="pillStatus">
          <span id="apiDot" class="dot warn"></span>
          <span class="k">البيانات</span>
          <span class="v" id="apiStatus">تحميل…</span>
        </div>
        <div class="pillStatus">
          <span class="k">الآن (عمّان)</span>
          <span class="v mono" id="nowClock">—</span>
        </div>
        <div class="pillStatus">
          <span class="k">هجري</span>
          <span class="v" id="hijriLine">—</span>
        </div>
        <div class="pillStatus">
          <span class="k">رمضان</span>
          <span class="v" id="ramadanLine">—</span>
        </div>
      </div>
    </header>

    <!-- Hero -->
    <section class="hero">
      <div class="heroLeft">
        <div class="heroKicker">ترتيب يومك في رمضان… بدون دراما.</div>
        <h1>أدخل دخولك — والباقي يُحسب تلقائياً.</h1>
        <p>
          خروج تلقائي (6.5 ساعات)، عدّاد الإفطار، الصلاة القادمة، وخريطة سير مباشرة داخل عمّان.
        </p>

        <div class="quickGrid">
          <div class="qcard">
            <div class="qk">متبقي على الإفطار</div>
            <div class="qv mono"><span id="tH">—</span>:<span id="tM">—</span>:<span id="tS">—</span></div>
            <div class="qs mono" id="iftarAt">—</div>
          </div>
          <div class="qcard">
            <div class="qk">الصلاة القادمة</div>
            <div class="qv" id="nextPrayer">—</div>
            <div class="qs mono" id="nextPrayerS">—</div>
          </div>
          <div class="qcard">
            <div class="qk">الفجر / المغرب</div>
            <div class="qv mono"><span id="fajrTime">—</span> • <span id="maghribTime">—</span></div>
            <div class="qs">مواقيت عمّان اليوم</div>
          </div>
        </div>
      </div>

      <div class="heroRight">
        <div class="glass">
          <div class="glassTop">
            <div class="glassTitle">دوامك اليوم</div>
            <div class="badge">ثابت: 6.5 ساعات</div>
          </div>

          <div class="form">
            <div class="field">
              <label>الاسم</label>
              <input id="name" placeholder="مثال: أحمد" autocomplete="off" />
            </div>
            <div class="field">
              <label>وقت الدخول (بصمة)</label>
              <input id="inTime" type="time" />
            </div>
          </div>

          <div class="result">
            <div class="big">
              <div class="bigK">الخروج المتوقع</div>
              <div class="bigV mono" id="kOut">—</div>
              <div class="bigS" id="kOutS">—</div>
            </div>

            <div class="miniGrid">
              <div class="mini">
                <div class="mk">متبقي للخروج</div>
                <div class="mv mono" id="kLeft">—</div>
                <div class="ms" id="kLeftS">—</div>
              </div>
              <div class="mini">
                <div class="mk">تقدم الدوام</div>
                <div class="mv mono" id="workPct">—</div>
                <div class="ms">من لحظة دخولك</div>
              </div>
              <div class="mini">
                <div class="mk">تقدم الصيام</div>
                <div class="mv mono" id="fastProg">—</div>
                <div class="ms" id="fastProgS">—</div>
              </div>
            </div>

            <div class="barWrap">
              <div class="bar">
                <div class="barFill" id="workBar"></div>
              </div>
              <div class="barHint">شريط الدوام (مباشر)</div>
            </div>
          </div>

          <div class="actions">
            <button id="calcBtn" class="primary">تحديث</button>
            <button id="saveBtn" class="ghost">حفظ دخول اليوم</button>
          </div>

          <details class="drawer">
            <summary>السجل والتصدير (محلي)</summary>
            <div class="drawerBody">
              <div class="tiny">يحفظ داخل المتصفح فقط. لا يتم إرسال أي بيانات للخارج.</div>
              <div class="tableWrap">
                <table>
                  <thead><tr><th>التاريخ</th><th>الاسم</th><th>دخول</th><th>خروج متوقع</th></tr></thead>
                  <tbody id="logBody"><tr><td colspan="4" class="tiny">لا يوجد سجل بعد.</td></tr></tbody>
                </table>
              </div>
              <div class="tiny" id="logStats">—</div>
              <div class="actions2">
                <button id="exportCSV" class="ghost">تصدير CSV</button>
                <button id="clearLog" class="ghost danger">مسح السجل</button>
              </div>
            </div>
          </details>

          <div class="tiny footnote">ملاحظة: مواقيت الصلاة والعدّادات للعرض/التخطيط فقط — لا تدخل ضمن ساعات الدوام.</div>
        </div>
      </div>
    </section>

    <!-- Main Grid -->
    <main class="grid">

      <!-- Ramadan Content -->
      <section class="card">
        <div class="cardHead">
          <div>
            <div class="cardTitle">رمضان اليوم</div>
            <div class="cardSub">معلومة مفيدة + دعاء قصير + حدث تاريخي (مبسط) + نصيحة عملية للفريق.</div>
          </div>
          <div class="cardTools">
            <button id="newTip" class="ghost">نصيحة جديدة</button>
            <button id="refreshPT" class="ghost">تحديث المواقيت</button>
          </div>
        </div>

        <div class="cardBody">
          <div class="tiles">
            <div class="tile gold">
              <div class="tk">رمضان</div>
              <div class="tv" id="ramDay">—</div>
              <div class="ts">يوم الشهر</div>
            </div>
            <div class="tile sky">
              <div class="tk">المغرب</div>
              <div class="tv mono" id="ptMag">—</div>
              <div class="ts">وقت الإفطار</div>
            </div>
            <div class="tile green">
              <div class="tk">الفجر</div>
              <div class="tv mono" id="ptFajr">—</div>
              <div class="ts">بداية الصيام</div>
            </div>
            <div class="tile">
              <div class="tk">العشاء</div>
              <div class="tv mono" id="ptIsha">—</div>
              <div class="ts">قيام/تراويح</div>
            </div>
          </div>

          <div class="contentGrid">
            <article class="contentCard">
              <div class="cTop">
                <div class="cTitle" id="themeTitle">معلومة اليوم</div>
                <div class="chipRow">
                  <span class="chip gold" id="ayahRef">آية: —</span>
                  <span class="chip sky" id="hadithRef">حديث: —</span>
                </div>
              </div>
              <p class="cText" id="themeText">—</p>
            </article>

            <article class="contentCard">
              <div class="cTop">
                <div class="cTitle">دعاء اليوم</div>
                <span class="chip green" id="actionTag">عمل اليوم: —</span>
              </div>
              <p class="cText" id="duaText">—</p>
            </article>

            <article class="contentCard">
              <div class="cTop">
                <div class="cTitle">رمضان عبر التاريخ</div>
                <span class="chip gold" id="histTag">—</span>
              </div>
              <p class="cText" id="histText">—</p>
            </article>

            <article class="contentCard">
              <div class="cTop">
                <div class="cTitle">نصيحة للفريق</div>
                <span class="chip">قصيرة • عملية</span>
              </div>
              <p class="cText" id="tipBox">—</p>
            </article>
          </div>

          <details class="drawer">
            <summary>المصدر والموثوقية</summary>
            <div class="drawerBody">
              <div class="tiny" id="methodNote">—</div>
              <div class="tiny" style="margin-top:8px;">
                ملاحظة: بعض الأحداث التاريخية قد تختلف تواريخها بين المصادر؛ نعرضها بصيغة مبسطة مع تنبيه عند وجود اختلاف.
              </div>
            </div>
          </details>
        </div>
      </section>

      <!-- Traffic -->
      <section class="card tall">
        <div class="cardHead">
          <div>
            <div class="cardTitle">حالة السير — عمّان</div>
            <div class="cardSub">Google Traffic Layer + قائمة “مناطق مهمة” للـ Zoom والتظليل.</div>
          </div>
          <div class="cardTools">
            <button id="toggleTraffic" class="ghost">إظهار/إخفاء السير</button>
            <button id="resetMap" class="ghost">إعادة ضبط</button>
          </div>
        </div>

        <div class="cardBody">
          <div class="mapLayout">
            <div class="mapWrap">
              <div id="map" class="map"></div>
              <div class="legend">
                <span class="lg heavy">Heavy</span>
                <span class="lg med">Medium</span>
                <span class="lg light">Light</span>
              </div>
            </div>

            <aside class="side">
              <div class="sideTitle">مناطق مهمة</div>
              <div class="sideSub">اضغط المنطقة للـ Zoom وتغيير الحالة (محلياً).</div>
              <div class="hotspots" id="hotspots"></div>

              <details class="drawer">
                <summary>ماذا تعني “الحالة”؟</summary>
                <div class="drawerBody">
                  <div class="tiny">
                    ألوان السير الحقيقية تظهر على الخريطة مباشرة (Traffic Layer).
                    “الحالة” هنا هي تمييز سريع لفريقك: تحددون مناطق ازدحام عادةً (عالي/متوسط/خفيف) لتسهيل التخطيط.
                    يتم حفظها محلياً داخل المتصفح.
                  </div>
                </div>
              </details>

              <div class="tiny footnote">لتفعيل الخريطة تحتاج <b>Google Maps API Key</b> داخل <span class="mono">docs/app.js</span>.</div>
            </aside>
          </div>
        </div>
      </section>

    </main>
  </div>

  <div class="toast" id="toast"><b id="toastT">—</b><div class="tiny" id="toastB"></div></div>

  <script src="./data.js"></script>
  <script src="./app.js"></script>
</body>
</html>
